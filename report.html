<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Goal Report</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body class="bg-light">
<div class="container my-5 text-center" id="reportSection">
  <h3>Progress Report: <span class="text-primary">{{goal_title}}</span></h3>
  <canvas id="progressChart" style="max-width: 700px; margin: auto;"></canvas>
</div>

<div class="text-center mb-5">
  <button class="btn btn-primary" onclick="downloadReport()">Download Report</button>
</div>

<script>
  const labels = {{labels}};
  const data = {
    labels: labels,
    datasets: [{
      label: 'Progress (%)',
      data: {{data}},
      borderColor: 'rgb(75, 192, 192)',
      tension: 0.3
    }]
  };

  const config = {
    type: 'line',
    data: data,
    options: {
      scales: {
        y: {
          beginAtZero: true,
          max: 100
        }
      }
    }
  };

  const chart = new Chart(document.getElementById('progressChart'), config);

  function downloadReport() {
    html2canvas(document.querySelector("#reportSection")).then(canvas => {
      const link = document.createElement('a');
      link.download = '{{goal_title}}_report.png';
      link.href = canvas.toDataURL();
      link.click();
    });
  }
</script>
</body>
</html>
